{"version":3,"sources":["file:///C:/GameECSProject/assets/scripts/systems/RoomSystem.ts"],"names":["RoomSystem","Damage","EnemyTag","Health","Position","TileTag","Trap","constructor","em","roomTemplate","playerId","createRoom","width","height","i","j","isPassable","layout","entityId","createEntity","addComponent","trapId","enemyId","playerPosition","getComponent","x","y","ch"],"mappings":"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","sourcesContent":["import { Damage } from \"../components/Damage\";\nimport { EnemyTag } from \"../components/Tag/EnemyTag\";\nimport { Health } from \"../components/Health\";\nimport { Position } from \"../components/Position\";\nimport { TileTag } from \"../components/Tag/TileTag\";\nimport { EntityManager } from \"../core/EntityManager\";\nimport { RoomTemplate } from \"../data/types\";\nimport { Trap } from \"../components/Trap\";\n\nexport class RoomSystem {\n   constructor(\n      private em: EntityManager,\n      public roomTemplate: RoomTemplate[],\n      private playerId: number\n   ) { }\n\n   createRoom() {\n      const width = this.roomTemplate[0].width;\n      const height = this.roomTemplate[0].height;\n\n      for (let i = 0; i < height; i++) {\n         for (let j = 0; j < width; j++) {\n            if (this.isPassable(this.roomTemplate[0].layout[i][j])) {\n               const entityId = this.em.createEntity();\n               this.em.addComponent(entityId, new TileTag(), TileTag);\n               this.em.addComponent(entityId, new Position(j, i), Position);\n            }\n\n            if (this.roomTemplate[0].layout[i][j] == 'T') {\n               const trapId = this.em.createEntity();\n               this.em.addComponent(trapId, new Position(i, j), Position);\n               this.em.addComponent(trapId, new Trap(new Damage(2)), Trap);\n            }\n\n            if (this.roomTemplate[0].layout[i][j] == 'E') {\n               const enemyId = this.em.createEntity();\n               this.em.addComponent(enemyId, new EnemyTag(), EnemyTag);\n               this.em.addComponent(enemyId, new Health(100), Health);\n               this.em.addComponent(enemyId, new Damage(5), Damage);\n               this.em.addComponent(enemyId, new Position(j, i), Position);\n            }\n\n            if (this.roomTemplate[0].layout[i][j] == 'P') {\n               const playerPosition = this.em.getComponent(this.playerId, Position);\n               if (playerPosition) {\n                  playerPosition.x = j;\n                  playerPosition.y = i;\n               }\n            }\n         }\n      }\n   }\n\n   isPassable(ch: string): boolean {\n      return ch === '.' || ch === 'P' || ch === 'E' || ch === 'T';\n   }\n}\n\n"]}