{"version":3,"sources":["file:///C:/GameECSProject/assets/scripts/core/EventBus.ts"],"names":["EventBus","listeners","on","event","fn","Set","add","off","delete","emit","payload","forEach","eventBus"],"mappings":";;;8BAcaA,Q;;;;;;;;;;;;;;;;;;;0BAAAA,Q,GAAN,MAAMA,QAAN,CAAe;AAAA;AAAA,eACZC,SADY,GAGhB,EAHgB;AAAA;;AAKpB;AACOC,QAAAA,EAAE,CACPC,KADO,EAEPC,EAFO,EAGP;AACA,cAAI,CAAC,KAAKH,SAAL,CAAeE,KAAf,CAAL,EAA4B;AAC1B,iBAAKF,SAAL,CAAeE,KAAf,IAAwB,IAAIE,GAAJ,EAAxB;AACD;;AACD,eAAKJ,SAAL,CAAeE,KAAf,EAAuBG,GAAvB,CAA2BF,EAA3B;AACD,SAdmB,CAgBpB;;;AACOG,QAAAA,GAAG,CACRJ,KADQ,EAERC,EAFQ,EAGR;AAAA;;AACA,wCAAKH,SAAL,CAAeE,KAAf,4CAAuBK,MAAvB,CAA8BJ,EAA9B;AACD,SAtBmB,CAwBpB;;;AACOK,QAAAA,IAAI,CACTN,KADS,EAETO,OAFS,EAGT;AAAA;;AACA,yCAAKT,SAAL,CAAeE,KAAf,6CAAuBQ,OAAvB,CAA+BP,EAAE,IAAIA,EAAE,CAACM,OAAD,CAAvC;AACD;;AA9BmB,O;;0BAiCTE,Q,GAAW,IAAIZ,QAAJ,E","sourcesContent":["import { Position } from \"../components/Position\";\r\n\r\nexport interface EventMap {\r\n  //positionChanged: { entity: number; newPos: Position };\r\n  movePath: {\r\n    entity: number;\r\n    path: Position[];\r\n  };\r\n\r\n  moveComplete: {\r\n    entity: number;\r\n  };\r\n}\r\n\r\nexport class EventBus {\r\n  private listeners: {\r\n    [E in keyof EventMap]?: Set<(payload: EventMap[E]) => void>\r\n  } = {};\r\n\r\n  // Подписка\r\n  public on<E extends keyof EventMap>(\r\n    event: E,\r\n    fn: (payload: EventMap[E]) => void\r\n  ) {\r\n    if (!this.listeners[event]) {\r\n      this.listeners[event] = new Set();\r\n    }\r\n    this.listeners[event]!.add(fn);\r\n  }\r\n\r\n  // Отписка\r\n  public off<E extends keyof EventMap>(\r\n    event: E,\r\n    fn: (payload: EventMap[E]) => void\r\n  ) {\r\n    this.listeners[event]?.delete(fn);\r\n  }\r\n\r\n  // Испускание\r\n  public emit<E extends keyof EventMap>(\r\n    event: E,\r\n    payload: EventMap[E]\r\n  ) {\r\n    this.listeners[event]?.forEach(fn => fn(payload));\r\n  }\r\n}\r\n\r\nexport const eventBus = new EventBus();\r\n"]}